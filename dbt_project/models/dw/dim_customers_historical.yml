# models/dw/dim_customers_historical.yml
version: 2
models: 
  - name: dim_customers_historical
    description: >
      SCD Type 2 dimension that tracks changes over time for customer attributes,
      based on snapshot metadata. Built incrementally using merge strategy.
    columns:
      - name: dim_cdc_key
        description: "Surrogate hash key generated by dbt snapshot macro to track changes in dimension."
        data_tests:
          - not_null
          - unique
        
      - name: customer_id
        description: "Primary business key for the customer"
        data_tests:
          - not_null
        
      - name: int_tec_fr_dt
        description: "Start date of the record's validity window"

      - name: int_tec_to_dt
        description: "End date of the record's validity window"

      - name: curr_flg
        description: "1 if the record is the current version, else 0"
        data_tests:
          - accepted_values:
              values: [0, 1]

      - name: del_flg
        description: "1 if the record was deleted from the source, else 0"
        data_tests:
          - accepted_values:
              values: [0, 1]

